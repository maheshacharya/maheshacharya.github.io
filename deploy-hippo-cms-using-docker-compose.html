<div class="file ">
      <div class="file-header">
  <div class="file-actions">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="/maheshacharya/hippo-docker-deployments/raw/master/docker-compose/README.md">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="/maheshacharya/hippo-docker-deployments/blame/master/docker-compose/README.md">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="/maheshacharya/hippo-docker-deployments/commits/master/docker-compose/README.md">History</a>
    </div>

        <a class="btn-octicon tooltipped tooltipped-nw" href="github-mac://openRepo/https://github.com/maheshacharya/hippo-docker-deployments?branch=master&amp;filepath=docker-compose%2FREADME.md" aria-label="Open this file in GitHub Desktop" data-ga-click="Repository, open with desktop, type:mac">
            <svg class="octicon octicon-device-desktop" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"></path></svg>
        </a>

          <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form js-update-url-with-hash" action="/maheshacharya/hippo-docker-deployments/edit/master/docker-compose/README.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="mNkMWN5vJqZkt0rZXQm3G41OolYWkXJxIb3tmH+wREDY9SvvSdUi6vDeN1OVthZ77fMpQQAU+o0Hsg5pVRRdsg==">
            <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Edit this file" data-hotkey="e" data-disable-with="">
              <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
            </button>
</form>
        <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form" action="/maheshacharya/hippo-docker-deployments/delete/master/docker-compose/README.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="ENuP7ziG7c+2PbRIp7giThCrVGoH56lQuK0HFFwxC1OnXUCA+7cg0CvLEypyloMJk2y4V2hyIiNDjAr5BvVx/Q==">
          <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Delete this file" data-disable-with="">
            <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
          </button>
</form>  </div>

  <div class="file-info">
      121 lines (98 sloc)
      <span class="file-info-divider"></span>
    4.92 KB
  </div>
</div>

      
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-deploy-hippo-cms-using-docker-compose" class="anchor" aria-hidden="true" href="#deploy-hippo-cms-using-docker-compose"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy Hippo CMS using Docker Compose</h1>
<p>Hippo CMS is one of the simple yet sophisticated Open Source Java web application platform, procedures to properly deploy Hipo CMS application requires covering a lot of areas of Dev-Ops tooling and concepts. Hippo CMS uses Apache Jackrabbit JCR repository, achieving a scalable deployment procedure makes it a true enterprice ready content management platform.</p>
<h1><a id="user-content-goals" class="anchor" aria-hidden="true" href="#goals"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Goals</h1>
<ul>
<li>Deploy containerized Hippo CMS application on a single node Docker host VM using Docker Compose.</li>
<li>Use MySQL Database as persistance data storage for the repository.</li>
<li>Run 3 instances of Hippo CMS for to achieve a desired scalability of website and cms applications.</li>
<li>Run Apache as Load Balancer and Reverse Proxy.
<ul>
<li>Use round-robin load balancing with stickness enabled.</li>
<li>Stickiness is important for CMS application as it is stateful.</li>
</ul>
</li>
</ul>
<h1><a id="user-content-requirements" class="anchor" aria-hidden="true" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h1>
<ul>
<li>Linux Server VM (Ubuntu, RHEL, CentOS etc.)</li>
<li>Docker</li>
<li>Docker Compose</li>
</ul>
<h1><a id="user-content-our-test-platform-specs" class="anchor" aria-hidden="true" href="#our-test-platform-specs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Our test platform specs</h1>
<ul>
<li>Host VM</li>
<li>Ubuntu 18.04 on AWS</li>
<li>Docker version: 18.06.1-ce</li>
<li>Docker Compose Version: 1.22.0</li>
</ul>
<h2><a id="user-content-deployment-architecture" class="anchor" aria-hidden="true" href="#deployment-architecture"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deployment Architecture</h2>
<pre><code>                                                  +-----------+
                      |                           |   MySQL   |
    Database          |                           +-----^-----+
                      |                                 |
   ----------- -------|                                 |
                      |            +-------------------++-------------------+
                      |            |                    |                   |
    Hippo CMS         |    +-------+------+       +-----+------+    +-------+------+
                      |    |   Node #1    |       |   Node #2  |    |   Node #3    |
                      |    +-------^------+       +-----+------+    +-------^------+
   -------------------|            |                    |                   |
                      |            +--------------------+-------------------+
                      |                                 |
    LB/Reverse Proxy  |                           +-----+------+
                      |                           |  Apache    |
                      |                           +------------+
                      
</code></pre>
<p>This deployment architecture contains:</p>
<ul>
<li>MySQL running in a single container with host volume mapping for persistent storage.</li>
<li>Three instances of Hippo CMS running in separate containers with links to MySQL container</li>
<li>Apache (httpd) running as a reverse proxy and load balancer.</li>
</ul>
<h2><a id="user-content-container-images" class="anchor" aria-hidden="true" href="#container-images"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Container Images</h2>
<ul>
<li>MySQL : <a href="https://hub.docker.com/_/mysql/" rel="nofollow">https://hub.docker.com/_/mysql/</a></li>
<li>Hippo Project: <a href="https://hub.docker.com/r/maheshacharya/myhippoproject-docker-deployment-demo-mysql/" rel="nofollow">https://hub.docker.com/r/maheshacharya/myhippoproject-docker-deployment-demo-mysql/</a></li>
<li>Apache2 : <a href="https://hub.docker.com/r/rgoyard/apache-proxy/" rel="nofollow">https://hub.docker.com/r/rgoyard/apache-proxy/</a></li>
</ul>
<h2><a id="user-content-apply-configuration-changes" class="anchor" aria-hidden="true" href="#apply-configuration-changes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apply Configuration Changes</h2>
<p>Modify <em><a href="https://github.com/maheshacharya/hippo-docker-deployments/tree/master/docker-compose/apache2/sites-available/default">default</a></em> and <em><a href="https://github.com/maheshacharya/hippo-docker-deployments/tree/master/docker-compose/apache2/sites-available/default-ssl">default-ssl</a></em> file under <em><a href="https://github.com/maheshacharya/hippo-docker-deployments/tree/master/docker-compose/apache2/sites-available">apache2/sites-available</a>.</em> to add proper server/domain name:
Replace <code>cloud-hub.co</code> with your own server DNS name.</p>
<h2><a id="user-content-deploy-hippo-cms" class="anchor" aria-hidden="true" href="#deploy-hippo-cms"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy Hippo CMS</h2>
<p>Change current working directory to docker-compose and then run:</p>
<pre><code>$ docker-compose up -d
</code></pre>
<h2><a id="user-content-terminal-output" class="anchor" aria-hidden="true" href="#terminal-output"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Terminal Output</h2>
<p>Successful deployment out will resemble something like below:</p>
<pre><code>Creating network "docker-compose_default" with the default driver
Creating docker-compose_hippo-mysql-database_1 ... done
Creating docker-compose_hippo3_1               ... done
Creating docker-compose_hippo2_1               ... done
Creating docker-compose_hippo1_1               ... done
Creating docker-compose_apache_1               ... done
</code></pre>
<h2><a id="user-content-remove-appication-stack" class="anchor" aria-hidden="true" href="#remove-appication-stack"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remove Appication Stack</h2>
<pre><code>$ docker-compose down
</code></pre>
<h2><a id="user-content-terminal-output-1" class="anchor" aria-hidden="true" href="#terminal-output-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Terminal Output</h2>
<p>Successful removal will display following output in terminal</p>
<pre><code>Stopping docker-compose_apache_1               ... done
Stopping docker-compose_hippo3_1               ... done
Stopping docker-compose_hippo1_1               ... done
Stopping docker-compose_hippo2_1               ... done
Stopping docker-compose_hippo-mysql-database_1 ... done
Removing docker-compose_apache_1               ... done
Removing docker-compose_hippo3_1               ... done
Removing docker-compose_hippo1_1               ... done
Removing docker-compose_hippo2_1               ... done
Removing docker-compose_hippo-mysql-database_1 ... done
Removing network docker-compose_default
</code></pre>
<h1><a id="user-content-reference-links" class="anchor" aria-hidden="true" href="#reference-links"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference Links</h1>
<ul>
<li>Docker: <a href="https://docs.docker.com/" rel="nofollow">https://docs.docker.com/</a></li>
<li>Docker Compose: <a href="https://docs.docker.com/compose/" rel="nofollow">https://docs.docker.com/compose/</a></li>
<li>Hippo CMS: <a href="https://www.onehippo.org/trails/getting-started/hippo-essentials-getting-started.html" rel="nofollow">https://www.onehippo.org/trails/getting-started/hippo-essentials-getting-started.html</a></li>
</ul>
</article>
  </div>

    </div>
